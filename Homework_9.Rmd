---
title: "Homework_9"
author: "Maha Siva"
date: "2025-04-17"
output: pdf_document
---

Github Link: 


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(moderndive)
library(effectsize)

```

# Question 1 
```{r}
solder <- read.csv("/Users/mahasivasubramanian/Desktop/SDS315/solder.csv")


```

### Part A
Part A: Make two plots. The first plot should provide evidence that the size of the opening on the solder
gun is related to the number of skips. The second should provide evidence that the thickness of the alloy
used for soldering is related to the number of skips. Give each plot an informative caption describing what is
shown in the plot

```{r}
library(ggplot2)
ggplot(solder) + geom_boxplot(aes(x=skips, fill=Opening))

```

```{r}
ggplot(solder) + geom_boxplot(aes(x=skips, fill=Solder))

```

### Part B 

```{r}
model_skip2 = lm(skips ~ Solder + Opening + Solder:Opening, data=solder)
#boot_skip2 = do(10000) * lm(skips ~ Solder + Opening + Solder:Opening, data=resample(solder))
confint(model_skip2, level = .95)
get_regression_table(model_skip2, conf.level = 0.95, digits=2)
coef(model_skip2)


```
### Part C 

interpretation 
* the baseline number of skips skips that are large and thick is .39. 
* the main effect of thin solder is 2.28 units. this is the effect of thin solder in isolation. 
* the main effect of medium opening is 2.41. this is the effect of medium size opening on skips in isolation 
* the main effect of small opening is 5.12. this is the effect of small opening on skips in isolation. 
* the interaction effect for thin solder and medium size opening is -.74. In other words, when we have both solder thin and a medium opening would produce 0.74 less skips that what we would have expected from summing the individual “isolated” effects of the two variables.
* the interaction effect for the thin solder and a small opening is 9.65. In other words, when we have both solder thin and small opening we would have 9.65 greater than what you expect from summing the individual “isolated” effects of the two variables.

### Part D 
Smallest number of skips will be gained from solder thin and medium opening. 

# Question 2 

```{r}
groceries <- read.csv("/Users/mahasivasubramanian/Desktop/SDS315/groceries.csv")

```

```{r}

groceries %>%
  group_by(Store) %>%
  summarize(mean_price = mean(Price, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(Store, mean_price), y = mean_price)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  coord_flip() +
  labs(x = "Store", y = "Average Price", title = "Average Price of Products by Store")
```
Caption 

### Part B 
```{r, fig.width=8, fig.height=12}
groceries %>%
  group_by(Product) %>%
  summarize(num_stores = n_distinct(Store)) %>%
  ggplot(aes(x=Product, y=num_stores)) + geom_bar(stat = "identity", fill = "darkseagreen") +
  coord_flip() 



```
### Part C 
```{r}
lm_groceries = lm(Price ~ Product + Type, data=groceries)
confint(lm_groceries, level = 0.95)
coef(lm_groceries)
get_regression_table(lm_groceries, conf.level = 0.95, digits=2)

```

Compared with ordinary grocery stores, convenience stores charge somewhere between .41 and .92 dolarrs more for the smame product. 

### Part D 
```{r}

lm_groceries1 = lm(Price ~ Product + Store, data=groceries)
confint(lm_groceries1, level = 0.95)
get_regression_table(lm_groceries1, conf.level = 0.95, digits=2)

```



### Part E

From the model, it can be seen that H-E-B has a coefficient of -0.65 (95% Cl: [-0.95, -0.35]) and Central Market has a coefficient of -0.57 (95% el: [-0.92, -0.23]). Therefore the estimated price difference between Central Market and H-E-B is 0.08, meaning that central market charges slightly more for the same product. 


### Part F 
```{r}
groceries <- groceries %>% 
  mutate(Income10k = round(Income / 10000, 0))

groceries2 = lm(Price~Product + Income10k, data=groceries)
get_regression_table(groceries2, conf.level=.95, digits=3)

standardize_parameters(groceries2)

```

Based on the sign of the Income10k coefficient, consumers in poorer ZIP codes seem to pay more for the same product, on average. The coefficient is negative, meaning that as income increases, the expected price decreases slightly. A one-standard deviation increase in the income of a ZIP code seems to be associated with a 0.04 standard-deviation decrease in the price that consumers in that ZIP code expect to pay for the same product.





# Problem 3 


### A - ZIP codes with a higher percentage of minority residents tend to have more FAIR policies per 100 housing units.

This statement is true. According to Figure A, the model has a R-squared value of .5163 which indicates that 51.6% of the variability in product prices can be explained by the model which shows that it is a moderately strong model. In addition, the slope for minority is [.009, .018]. As 0 is not included in the confidence interval, there it is statistically significant.


### B. The evidence suggests an interaction effect between minority percentage and the age of the housing stock in the way that these two variables are related to the number of FAIR policies in a ZIP code. - undecidable

FALSE

The model does not include an interaction term for age and minority. The model E has a 95% confidence interval for age of [-.002,.013] and since 0 is in the interval- there is it not statistically significant.

### C. The relationship between minority percentage and number of FAIR policies per 100 housing units is stronger in high-fire-risk ZIP codes than in low-fire-risk ZIP codes. - Undecidable

###D. Even without controlling for any other variables, income “explains away” all the association between minority percentage and FAIR policy uptake. FALSE 

According to model D, with minority + income, minority remains statistically significant with a p level of .002 so even when income is added minority percentage still has a statistically significant association with FAIR policies. 

### E. Minority percentage and number of FAIR policies are still associated at the ZIP code level, even after controlling for income, fire risk, and housing age. TRUE 

In model E, after controlling for all the variables listed above such as income, fire risk, housing age. The coefficient for minority is estimate =.008 and p =.006 which indicates statistically significance. Therefore minority percentage remains a significant perdictor of FAIR policies. 




